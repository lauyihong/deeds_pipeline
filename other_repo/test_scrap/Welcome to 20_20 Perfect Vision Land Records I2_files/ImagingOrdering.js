var ctrlID="",srcImg="",containerID="",fitType="",zoomFactor="",arrImages,preImages,coverage=0,currCount=0,loaded,i,covered,timerID,_timeLabel,_timeBegin,_timeEnd;function preInit(f,c,b,a,d,e){srcImg=f;containerID=a;ctrlID=c;fitType=d;zoomFactor=e;_timeLabel=document.getElementById(b);loadSize()}function loadSize(){if(document.getElementById(containerID).style.width!=0||document.getElementById(containerID).style.height!=0)loadImages();else timerID=setTimeout("loadSize();",10)}function loadImages(){var b=parseInt(document.getElementById(containerID).style.width),a=parseInt(document.getElementById(containerID).style.height);srcImg+="&CNTWIDTH="+b;srcImg+="&CNTHEIGHT="+a;srcImg+="&FITTYPE="+fitType;srcImg+="&ZOOM="+zoomFactor;arrImages=new Array(srcImg);if(document.images){preImages=[];currCount=0;loaded=[];for(i=0;i<arrImages.length;i++){preImages[i]=new Image;preImages[i].src=arrImages[i]}for(i=0;i<preImages.length;i++){loaded[i]=false;var c=new Date;_timeBegin=c.getTime()}checkLoad()}}function checkLoad(){if(currCount==preImages.length){if(document.getElementById(ctrlID)==null||document.getElementById(ctrlID)==undefined)return;document.getElementById(ctrlID).src=srcImg;return}for(i=0;i<=preImages.length;i++)if(loaded[i]==false&&preImages[i].complete){loaded[i]=true;currCount++;var a=new Date;_timeEnd=a.getTime();if(_timeLabel!=null)_timeLabel.innerHTML=_timeLabel.innerHTML+(_timeEnd-_timeBegin)/1e3}timerID=setTimeout("checkLoad();",10)}function GetImageSize(b,a){var d,c,f=document.getElementById(a).style.width,e=document.getElementById(a).style.height;if(document.getElementById(a).style.width.length>0){d=doInt(f)-40;c=doInt(e)-49;document.getElementById(b).style.width=d+"px";document.getElementById(b).style.height=c+"px"}}var DragImg={obj:null,objRoot:null,init:function(b,a,d){var c=document.getElementById(d);if(b!=null&&a!=null){b.onmousedown=DragImg.start;c.onmousedown=DragImg.start;objRoot=a}},start:function(b){var a=DragImg.obj=this;if(a==null)return false;b=DragImg.fixE(b);a.lastMouseX=b.clientX;a.lastMouseY=b.clientY;a.onmousemove=DragImg.drag;a.onmouseup=DragImg.end;document.onmouseup=DragImg.end;return false},drag:function(a){a=DragImg.fixE(a);var d=DragImg.obj,c=a.clientY,b=a.clientX;objRoot.scrollTop+=DragImg.obj.lastMouseY-c;objRoot.scrollLeft+=DragImg.obj.lastMouseX-b;DragImg.obj.lastMouseX=b;DragImg.obj.lastMouseY=c;return false},end:function(){var a=DragImg.obj;a.onmousemove=null;a.onmouseup=null;a=null},fixE:function(a){if(typeof a=="undefined")a=window.event;if(typeof a.layerX=="undefined")a.layerX=a.offsetX;if(typeof a.layerY=="undefined")a.layerY=a.offsetY;return a}},CheckBox_AddAll,CheckBox_DocumentDetails,CheckBox_Certificate,CheckBox_Pages,CheckBox_TranscriptImage,CheckBox_Encumbrance,RadioButton_SelectAll,RadioButton_SelectCurrent,RadioButton_SelectPages,TextBox_SelectPages,ImgPageCount,CertPageCount,EncPageCount,TransImageCount,AllowCustomPages,EnableDocDetails;function InitChosingCriteria(b,f,a,d,e,j,h,l,n,k,q,m,o,p,g,c,i){CheckBox_AddAll=document.getElementById(j);CheckBox_DocumentDetails=document.getElementById(h);CheckBox_Certificate=document.getElementById(l);CheckBox_Pages=document.getElementById(k);CheckBox_Encumbrance=document.getElementById(n);RadioButton_SelectAll=document.getElementById(q);RadioButton_SelectCurrent=document.getElementById(m);RadioButton_SelectPages=document.getElementById(o);TextBox_SelectPages=document.getElementById(p);EnableDocDetails=f;AllowCustomPages=g;CheckBox_TranscriptImage=document.getElementById(i);ImgPageCount=a;CertPageCount=d;EncPageCount=e;TransImageCount=c;if(b=="NoAction")return;if(b=="AllPages"&&a>0){CheckBox_AddAll.checked=false;CheckBox_DocumentDetails.checked=false;if(CheckBox_Certificate!=null)CheckBox_Certificate.checked=false;if(CheckBox_Encumbrance!=null)CheckBox_Encumbrance.checked=false;if(CheckBox_TranscriptImage!=null)CheckBox_TranscriptImage.checked=false;if(CheckBox_Pages.checked==false)CheckBox_Pages.checked=false;else CheckBox_Pages.checked=true;if(AllowCustomPages){RadioButton_SelectAll.checked=true;RadioButton_SelectCurrent.checked=false;RadioButton_SelectPages.checked=false;TextBox_SelectPages.disabled=true}}else if(b=="CurentPages"&&a>1){CheckBox_AddAll.checked=false;CheckBox_DocumentDetails.checked=false;if(CheckBox_Certificate!=null)CheckBox_Certificate.checked=false;if(CheckBox_Encumbrance!=null)CheckBox_Encumbrance.checked=false;if(CheckBox_TranscriptImage!=null)CheckBox_TranscriptImage.checked=false;if(CheckBox_Pages.checked==false)CheckBox_Pages.checked=false;else CheckBox_Pages.checked=true;if(AllowCustomPages){RadioButton_SelectAll.checked=false;RadioButton_SelectCurrent.checked=true;RadioButton_SelectPages.checked=false;TextBox_SelectPages.disabled=true}}else{if(CheckBox_AddAll.checked==false)CheckBox_AddAll.checked=false;else CheckBox_AddAll.checked=true;CheckBox_DocumentDetails.checked=true;if(CheckBox_Certificate!=null)CheckBox_Certificate.checked=d>0;if(CheckBox_Encumbrance!=null)CheckBox_Encumbrance.checked=e>0;if(CheckBox_TranscriptImage!=null)CheckBox_TranscriptImage.checked=c>0;CheckBox_Pages.checked=a>0;if(AllowCustomPages){RadioButton_SelectAll.checked=a>0;RadioButton_SelectCurrent.checked=false;RadioButton_SelectPages.checked=false}Panel_CheckBoxes_Disable(true)}if(!EnableDocDetails){CheckBox_DocumentDetails.disabled=true;CheckBox_DocumentDetails.checked=false}}function Panel_Pages_Disable(a){if(!AllowCustomPages)return;if(a){RadioButton_SelectAll.disabled=true;RadioButton_SelectCurrent.disabled=true;RadioButton_SelectPages.disabled=true;TextBox_SelectPages.disabled=true}else if(ImgPageCount>0){RadioButton_SelectAll.disabled=false;if(ImgPageCount>1){RadioButton_SelectCurrent.disabled=false;RadioButton_SelectPages.disabled=false;TextBox_SelectPages.disabled=!RadioButton_SelectPages.checked}}}function Panel_CheckBoxes_Disable(a){CheckBox_DocumentDetails.disabled=a;CheckBox_Pages.disabled=a;if(a){if(CheckBox_Certificate!=null)CheckBox_Certificate.disabled=a;if(CheckBox_Encumbrance!=null)CheckBox_Encumbrance.disabled=a;if(CheckBox_TranscriptImage!=null)CheckBox_TranscriptImage.disabled=a;Panel_Pages_Disable(a)}else{if(CertPageCount>0&&CheckBox_Certificate!=null)CheckBox_Certificate.disabled=a;if(EncPageCount>0&&CheckBox_Encumbrance!=null)CheckBox_Encumbrance.disabled=a;if(TransImageCount>0&&CheckBox_TranscriptImage!=null)CheckBox_TranscriptImage.disabled=a;ImgPageCount>0&&Panel_Pages_Disable(a)}}function CheckAllChanged(){if(CheckBox_AddAll.checked){Panel_Pages_Disable(false);CheckBox_DocumentDetails.checked=true;if(CertPageCount>0&&CheckBox_Certificate!=null)CheckBox_Certificate.checked=true;if(ImgPageCount>0){CheckBox_Pages.checked=true;if(AllowCustomPages)RadioButton_SelectAll.checked=true}if(EncPageCount>0&&CheckBox_Encumbrance!=null)CheckBox_Encumbrance.checked=true;if(TransImageCount>0&&CheckBox_TranscriptImage!=null)CheckBox_TranscriptImage.checked=true;if(AllowCustomPages){RadioButton_SelectCurrent.checked=false;RadioButton_SelectPages.checked=false;TextBox_SelectPages.disabled=true}Panel_CheckBoxes_Disable(true)}else{Panel_CheckBoxes_Disable(false);if(AllowCustomPages)if(RadioButton_SelectPages.checked)TextBox_SelectPages.disabled=false;else TextBox_SelectPages.disabled=true}if(!EnableDocDetails){CheckBox_DocumentDetails.disabled=true;CheckBox_DocumentDetails.checked=false}}function CheckPagesChanged(){if(CheckBox_Pages.checked){Panel_Pages_Disable(false);if(AllowCustomPages)if(RadioButton_SelectPages.checked)TextBox_SelectPages.disabled=false}else{Panel_Pages_Disable(true);if(AllowCustomPages)TextBox_SelectPages.disabled=true}}var chkBox_SaveCriteria,tr_DoNotShowCriteria;function InitSavingCriteria(b,a){chkBox_SaveCriteria=document.getElementById(b);tr_DoNotShowCriteria=document.getElementById(a)}function SaveCriteriaChanged(){if(chkBox_SaveCriteria.checked)tr_DoNotShowCriteria.style.visibility="visible";else tr_DoNotShowCriteria.style.visibility="hidden"}function CheckAllPagesChanged(){if(!AllowCustomPages)return;if(RadioButton_SelectAll.checked)TextBox_SelectPages.disabled=true}function CheckCurrentPageChanged(){if(!AllowCustomPages)return;if(RadioButton_SelectCurrent.checked)TextBox_SelectPages.disabled=true}function CheckSelectPagesChanged(){if(!AllowCustomPages)return;if(RadioButton_SelectPages.checked)TextBox_SelectPages.disabled=false}function removeIndex(a,c){var b=a.value.indexOf(c);if(b!=-1)return a.value.substring(0,b)+a.value.substring(b+c.toString().length+1,a.value.length)};